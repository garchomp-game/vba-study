# 試験対策メモ

- 1-8 function内での計算では、引数だけではなく、戻り値の関数名も最初から計算対象とすることができる。引数のデフォルトはintegerがたの場合0。
- 1-10 参照渡しする前の値を変更させたくない場合は値私、変更させる場合は参照渡しにする。
- 2-1 インデックスの開始を変える場合、dim numlist(3 to 5) as integer などとする
- 2-14 forでかっこの中に配列名が入っている場合、LBound(arr), UBound(arr)を疑うべし。
- 2-16 作問ミス発見
- 3-1 caseで1 to 9といった指定は可能。また、それ以外はswitchだとTRUEだが、vbaだとcase elseとなる。
- 3-3 case文では、if文と同じように等式が使える。等式を使う場合、select caseの対象はisに置き換え、case is >= 60 などという指定が可能。
- 3-4 case文ではカンマで区切って複数指定可能。補足として、1 to 3という指定方法は間の小数点も含まれるため、この問題では間違いとなる。
- 3-7 case文では、is >= 80の後、60 to 79だと、79.5でそれ以外の判定になってしまうため、60 to 80とすることでちゃんとカバーする必要がある。
- 3-11 do-while/loopのほかにdo/loop-whileもあるということは、当然のことながらdo/loop-untileもある。意味はrubyと同じ。
- 3-13 CStr()は、char stringの略。
- 3-20 activateはselectとほぼ同じ意味である。範囲選択されたところから、offcet(0, 1)移動するということは、範囲選択左上から一個右にずれたセルが通常選択されることになる。つまり、範囲選択の下段までは選択されない。範囲選択した範囲を足す場合は、Selection(for-each)を使う。
- 3-24 workbookのコレクションはworkbooksである。activeworkbookは、現在表示しているシート、thisworkbookは、現在VBEで開いている元シートを指す
- 3-28 何かループを抜けるときはexit ステートメントで抜けることができる。例えばexit doやexit for exit subなどである。
- 3-31 先に弾いてから評価しないと、すべての値を弾くことができない。fizzbuzzと同じ方式で、先に弾くことを優先することが大事。順番には意味があることを覚えておくこと。
- 3-32 forの中にdo-loopがあるというネスト構造になっている点に注意。内側から始まるのは周知の事実。プログラムを注意深く読むこと。
- 3-36 for eachの中で使われる要素変数は、事前にdimステートメントを使った宣言をすることは可能だが、variant型でなければならない。
- 4-1 ワークシートを開くopenメソッドは、workbooksコレクションの関数として定義されている。workbookは、それ単体のオブジェクトである。いわゆるjavaのPath等に相当する。workbooks.openは、いわゆるfindしてきているといえるので、コレクション操作と考えるのが妥当である。
- 4-2 セーブするときはsaveだけではなく、saveAsとする。Asを忘れないように。
- 4-3 ファイルをコピーする際は、FileCopyステートメントを使う。
- 4-4 Now関数は別途worksheetfunctionを使わなくてもよい。
- 4-10 ここではフォーマットを問う問題になっている。そのため、format関数で指定すればよい。
- 4-14 workbooksをオープンする際、rangeに記載されたテキストをそのまま使うことができる。この際、valueは必要ない。もちろんvalueをつけても問題ない。
- 5-7 存在するかを確認する方法の一つとして、countifを使うことができる。なお、match関数で一致しなかった場合はN/Aエラーを返すため不正解。
- 5-10 Large関数は、全体でn番目に大きい数を取得する(Large(Range selection, integer what_number))
- 5-12 Match(Range 検索値, Range[] 検索範囲, Integer 照合の型)
- 6-1 例えば、findで検索するとき、vbaという文字列が含まれてるものを探したい。この場合、文章全体と完全一致していない場合はxlPartとなる。xlWholeは本当に開始から終了まで丸々一致しているときに限る。
- 6-4 検索のキーはWhat、部分一致/完全一致化の指定はLookAtを指定する。
- 6-14 CurrentRegionは、アクティブセル領域を選択する。アクティブセル領域は、空白の列、行がなく、一つのテーブルとしてみなされる範囲である。
- 6-17 xlFilterValuesを追加することで、フィルターを配列で指定することができる。
- 6-18 autofilterは複数条件を指定することができる、リセットされるのは、引数を何も指定しなかったときのみ、何らかの引数が指定されているときは上書きするのではなく、単に条件が追加されるだけであることに注意
- 6-19 subtotal関数は、見えているセルだけを集計するもの。つまり、見出し部分のセルが表示されている場合、その行もカウントされる。
- 6-20 フィルターボタンが表示されているままになっている点に注意。AutoFilterに列数を指定しないと、フィルターボタンがなくなってしまう。フィルターボタンを残すには、何らかの列を指定することで残すことが可能。ひっかけ問題に注意
- 7-5 activesheetの並び替えの範囲を指定するには、setRangeをつかう。
- 7-8 sortのadd2には並べかえの方法に４種類の方法がある
  - xlSortOnValues
  - xlSortOnCellColor
  - xlSortOnFontColor
  - xlSortOnIcon
なお、xlSortOnValuesだけ複数系であることに注意
- 7-12 sortのHeaderプロパティでは、先頭の行をヘッダーとして指定する場合はxlYes、指定しない場合はxlNo、自動で判断する場合はxlGuessがある。この三つをしっかり簿覚えておくこと。
- 7-13 ソートの際、ふりがなベースか文字コードベースかを指定する際は、SortMethodを用いる。
- 7-14 今回の問題は、単にsortと入力すればすんだ話である。難しく考えすぎ。
- 7-15 次の三つのケースでは読み込まれない
① CSVファイルを読み込んだとき
② マクロ（VBA）でセルに漢字を入力したとき
③ 他のアプリケーションからセルにコピーしたとき
- 7-16 sortのならべかえとして、key1のほかにorder1などもある。order荷も数字がつくことに注意
- 7-17 phonetic.textである。phoneticは(N)の方であることに注意
- 7-20 ふりがな設定していない場合は一番後ろになる。問題文をよく見よう。
- 7-21 ふりがな指定してない場合は、phonetic.textを使ったときそのまま出力される。
- 7-22 ふりがな見設定の場合はそのまま出力される。つまり、nothingではなく=だったら未設定だと言うことがわかる。
- 7-23 空の文字列をセットするとエラーになる。
- 8-9 databodyrangeは見出しを含まないセルを選択するものだが、listrowsは、見出しを含まない行を選択するものである。
- 8-13 実は、構造化参照するとき、\[\#範囲]を省略した場合、\[#Data]を指定したことと同義となる。
- 8-15 構造化参照に、#dataを省略して、列指定子を指定することができる。例えば、Range("テーブルT3[[#Data],[レビュー数]]")は、Range("テーブルT3[レビュー数])とおなじである。
- 8-16 構造化参照でヘッダーを指定するにはHeadersをつかう。余談だがソートの見出しもソート対象に含めるかの場合はHeaderである。構造化参照する場合は複数系と覚えよう。
- 8-17 ListObjectをAutoFilterで絞り混んだ結果をcopyする場合、通常は見出しの行も含まれる。
- 8-20 ListObject.ListColumns.Addとすると、単にテーブルの一番右に新しい列が追加される。引数は省略可能。引数としては挿入位置の指定が可能
- 8-23 ListObject.ListColumns.Addで、引数として数字を指定した場合、指定列の手前に新しい列が追加される。また、 ListColumns(3).Rangeに値を代入した場合、DataBodyRangeではないので、見出しも含めて値が設定される。よって、見出し名も変わる。
- 8-24 構造化参照を使ってレコードを追加するには、offsetを使う。
- 9-3 1004番のエラーは実行時エラー、９番のエラーがコンパイルエラーとして主に分けられる
- 9-5 エラーが発生したときは、on Errorステートメントを使う。基本的にはon error goto ラベル名といった形で使う
- 9-7 全角/半角を変換するには、strconvを使う
- 9-9 構　文エラーは存在しなく、文法ミスの場合は記述エラーという名称でくくられる。
- 9-14 Err.Description。エラーの詳細と覚えよう。
- 9-16 指定されたシートと同じ名前で上書きする分にはセーフだが、定義済みのシート名を別のシートで使うのはNG。
- 10-9 ステップインを実行するには、F8キーである。
- 10-10 isNumericは、小数点や整数や、文字列としてくぉーとで囲ってあっても、数値に変換可能であればtrueとなる。
- 10-18 TypeName("12.34")は、くぉーとで囲まれているので、文字列として扱われる。素直に評価される点に注意

次は6-9から（2週目）